<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/black.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">
    <style>
        .grid-area {
            display: grid;
            grid-auto-flow: column;
        }

        .reveal pre code {
            max-height: none;
        }

        .reveal pre {
            width: 100%;
        }

        .inline-image img {
            margin: 0;
        }

        .inline-image {
            display: inline-flex;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section data-timing="20">
            <h1>Functional Kotlin</h1>
<!--            <img alt="necronomicon but with the gradle logo" src="gradlenomicon.jpg" height="466" width="386">-->
            <aside class="notes">

            </aside>
        </section>
        <section data-timing="60">
            <h1>About Me</h1>
            <aside class="notes">
                You can also find me on the Chicago Tech and Kotlin slacks and the CJUG discord
            </aside>
            <h3>John Burns</h3>
            <div class="grid-area">
                <div style="text-align: left">
                    <p>Staff Engineer @ GrubHub</p>
                    <p>CKUG Co-Organizer</p>
                    <p class="inline-image"><img alt="twitter logo" src="Twitter-Logo.png" height="48" width="48"/>
                        <span style="padding-left: .5em">@wakingrufus</span></p>
                    <p class="inline-image"><img alt="fediverse logo" src="fediverse.png" height="48" width="48"/>
                        <span style="padding-left: .5em">@wakingrufus@bigshoulders.city</span>
                    </p>
                    <p></p>
                    <p class="inline-image"><img alt="github logo" src="github-logo.png" height="48" width="48"/>
                        <span style="padding-left: .5em">wakingrufus</span>
                    </p>
                </div>
            </div>
        </section>
        <section data-timing="60">
            <img alt="GrubHub logo" src="gh-logo.png" height="194" width="688">
            <aside class="notes">
                HQ is chicago
                we have been publicly traded and operating off our own revenue and profits since 2014
                What I do: Service Platform Engineering: JVM Stewardship
            </aside>
            <ul>
                <li>Fully Remote and Hybrid Remote Roles</li>
                <li>Unlimited PTO</li>
                <li>8-16 weeks of parental leave</li>
                <li>4.5 day work week</li>
            </ul>
        </section>
        <section data-timing="90">
            <h1>About You</h1>
            <h4 class="fragment">Experienced with OOP Java</h4>
            <h4 class="fragment">Experienced with Functional Programming</h4>
            <h4 class="fragment">Experienced with Kotlin</h4>
            <h4 class="fragment">Experienced with FP + Kotlin</h4>
            <aside class="notes">

            </aside>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>What is Functional Programming?</h2>
            </section>
            <section data-auto-animate data-timing="60">
                <h2>What is Functional Programming?</h2>
                <h4>Similar Principles as OOP</h4>
                <aside class="notes">
                    Function and OO are not at odds
                    they share many of the same principles
                </aside>
                <ul>
                    <li class="fragment">Encapsulation</li>
                    <li class="fragment">DRY</li>
                    <li class="fragment">GoF Design Patterns</li>
                    <li class="fragment">Favor composition over inheritance</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="90">
                <h2>What is Functional Programming?</h2>
                <h4>Differences from OOP</h4>
                <aside class="notes">
                    But there are some differences
                </aside>
                <ul>
                    <li class="fragment">Verbs vs Nouns</li>
                    <li class="fragment">Limit mutable state</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="120">
                <h2>What is Functional Programming?</h2>
                <h4>What is a functional language?</h4>
                <aside class="notes">
                    for us, it doesn't matter
                    kotlin is multiparadigm
                    you can write kotlin just like OOP Java
                    you can mix FP with OOP
                    real programs have side effects
                    No program is 100% pure functional
                    Push state out to the ‘edges’.
                    Place application’s core data and logic in immutable constructs (value types).
                    Represent state as objects with mutable references to immutable core constructs.
                    Shell: OOP, state, IO, Side effects, GUI
                    Core: Pure functions, stateless, logic
                    Use functional parameters to inject functions with side effects
                    Use functional parameters on the boundary of your shell/core
                    but certain FP concepts are easier, or default in kotlin
                </aside>
                <ul>
                    <li class="fragment">Java and Kotlin are multi-paradigm</li>
                    <li class="fragment">real world projects are rarely pure OOP or FP</li>
                    <li class="fragment">Kotlin gives us more FP</li>
                </ul>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>What Makes Kotlin more "Functional"?</h2>
                <aside class="notes">
                </aside>
                <ul>
                    <li class="fragment">Immutable Data</li>
                    <li class="fragment">"First-class" Functions</li>
                    <li class="fragment">Pure Functions</li>
                    <li class="fragment">Higher Order Functions</li>
                </ul>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="90">
                <h2>Immutable Data</h2>
                <aside class="notes">
                    Value of Values by Rich Hickey
                </aside>
                <ul>
                    <li class="fragment">Thread safe</li>
                    <li class="fragment">Avoids temporal coupling</li>
                    <li class="fragment">No need for defensive copies</li>
                    <li class="fragment">Helps prevent side effects</li>
                    <li class="fragment">Easier to cache</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Immutable Data</h2>
                <aside class="notes">
                    in OOP classes have data nd behavior
                    in FP, keep state and behavior separate
                    classes for data, functions for behavior
                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
data class ImmutableDataValue(val stringData: String)
                </code></pre>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="60">
                <h2>First-Class Functions</h2>
                <aside class="notes">
                    This makes the next 2 things easier to do.
                    I run
                    I like running
                </aside>
                <ul>
                    <li class="fragment">Classes are nouns</li>
                    <li class="fragment">Methods are verbs</li>
                    <li class="fragment">Functions are verbs and gerunds</li>
                    <li class="fragment">Kotlin has first class functions</li>
                    <li class="fragment">Static methods and functional types not needed</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="120">
                <h2>First-Class Functions</h2>
                <aside class="notes">

                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
fun bigDecimalEquals(one: BigDecimal, two: BigDecimal) : Boolean {
  return one.compareTo(two) == 0
}

fun bigDecimalEquals(one: BigDecimal, two: BigDecimal) : Boolean
    = one.compareTo(two) == 0

val bigDecimalEquals: (Int, Int) -> Boolean
    = { one, two -> one.compareTo(two) == 0 }
                </code></pre>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>Pure Functions</h2>
                <aside class="notes">
                    Same inputs will always yield same outputs
                </aside>
                <ul>
                    <li class="fragment">Deterministic: Same inputs will always yield same outputs</li>
                    <li class="fragment">No Side-Effects: Do not access or mutate shared state</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Pure Functions</h2>
                <h4 data-id="subtitle">Non-Deterministic</h4>
                <aside class="notes">

                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
data class ChatMessage(
    val user: String
    val timestamp: Instant
    val message: String)


fun newMessage(message: String) : ChatMessage {
  return ChatMessage(
    user = System.getProperty("user.name"),
    timestamp = Instant.now(),
    message = message)
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Pure Functions</h2>
                <h4 data-id="subtitle">Deterministic</h4>
                <aside class="notes">

                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
data class ChatMessage(
    val user: String
    val timestamp: Instant
    val message: String)

fun newMessage(
    message: String,
    user: String,
    timestamp: Instant) : ChatMessage {
  return ChatMessage(
    user = user,
    timestamp = timestamp,
    message = message)
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Pure Functions</h2>
                <h4 data-id="subtitle">Side Effects</h4>
                <aside class="notes">

                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
fun addNewMessageSideEffect(messages: ArrayList&ltChatMessage>,
    newMessage: ChatMessage) {
  messages.add(newMessage)
  // Modifies input
}

val externalMessages: List&ltChatMessage> = ArrayList()

fun addNewMessageSideEffect2(newMessage: ChatMessage) {
  externalMessages.add(newMessage)
  // Modifies something outside of scope
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Pure Functions</h2>
                <h4 data-id="subtitle">No Side Effects</h4>
                <aside class="notes">

                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
fun addNewMessage(
    messages: List&ltChatMessage>,
    newMessage: ChatMessage) : List&ltChatMessage> {
  return listOf(*messages.toTypedArray(), newMessage)
}
                </code></pre>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>Higher-Order Functions</h2>
                <aside class="notes">

                </aside>
                <ul>
                    <li class="fragment">Take a function as an input</li>
                    <li class="fragment">Return a function as output</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Higher-Order Functions</h2>
                <aside class="notes">
                    abstract code structure.
                    Encapsulate more abstract concepts,
                    this is why adv. FP has all these complex concepts
                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
fun twice(f: (T)->T) : (T)->T = f(f(it))

fun f(x: Int) = x + 3

{
  println(twice(::f)(7)) // prints "13"
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Higher-Order Functions</h2>
                <h4>Common Examples</h4>
                <aside class="notes">

                </aside>
                <ul>
                    <li class="fragment">Kotlin Scope Functions</li>
                    <li class="fragment">Collection Operations (map, filter, etc)</li>
                    <li class="fragment">Memoize</li>
                    <li class="fragment">Lazy delegate</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="30">
                <h4>Kotlin Scope Functions</h4>
                <aside class="notes">

                </aside>
                <table>
                    <thead style="font-weight: bold;">
                    <tr style="border-style: solid; border-width: 4px;">
                        <td style="border-style: solid; border-width: 1px;">Function</td>
                        <td style="border-width: 1px;">extension</td>
                        <td style="border-style: solid; border-width: 1px;">this or it</td>
                        <td style="border-style: solid; border-width: 1px;">Block return</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td style="border-style: solid;border-width: 1px;">let</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                        <td style="border-style: solid;border-width: 1px;">it</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                    </tr>
                    <tr>
                        <td style="border-style: solid;border-width: 1px;">run</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                        <td style="border-style: solid;border-width: 1px;">this</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                    </tr>
                    <tr>
                        <td style="border-style: solid;border-width: 1px;">run</td>
                        <td style="border-style: solid;border-width: 1px;">no</td>
                        <td style="border-style: solid;border-width: 1px;">--</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                    </tr>
                    <tr>
                        <td style="border-style: solid;border-width: 1px;">with</td>
                        <td style="border-style: solid;border-width: 1px;">no</td>
                        <td style="border-style: solid;border-width: 1px;">this</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                    </tr>
                    <tr>
                        <td style="border-style: solid;border-width: 1px;">apply</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                        <td style="border-style: solid;border-width: 1px;">this</td>
                        <td style="border-style: solid;border-width: 1px;">no</td>
                    </tr>
                    <tr>
                        <td style="border-style: solid;border-width: 1px;">also</td>
                        <td style="border-style: solid;border-width: 1px;">yes</td>
                        <td style="border-style: solid;border-width: 1px;">it</td>
                        <td style="border-style: solid;border-width: 1px;">no</td>
                    </tr>
                    </tbody>
                </table>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>Types</h2>
                <aside class="notes">
                    Types might sound like an OOP concept to you, but they are an important part of both paradigms
                    How does the type system help you write functional code?
                    throwing exceptions is a side effect.
                    we need to avoid it so that our functions truly only have a single defined return value (pure)
                    no NPE, no other exceptions, etc

                    They also help us make common higher-order functions more concrete
                    First lets take a look at some feature of the kotlin type system that help with FP
                </aside>
                <ul>
                    <li class="fragment">Nullability</li>
                    <li class="fragment">Sealed Classes</li>
                    <li class="fragment">Pattern Matching</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Types</h2>
                <h4>Monad</h4>
                <aside class="notes">
                    Monads are important to FP b/c they wrap our common higher order functions into something more tangible,
                    and make them composable

                    composable means they are easy to apply another higher order function to, and retain the same type
                    think Optional.or() or Stream.map in java
                </aside>
                <ul>
                    <li class="fragment">Higher-order function as an object</li>
                    <li class="fragment">Composable</li>
                </ul>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Types</h2>
                <h4>Optional</h4>
                <aside class="notes">
                    Java optionals
                    Kotlin bakes this into nullable types, but its still a monad, we just have nice syntax sugar around it
                </aside>
                <pre class="java"><code data-trim data-noescape>
final var opt = Optional.ofNullable(...);
opt.isPresent(); // true or false
opt.or(fallback);
opt.map(String::length).orElse(0);
                </code></pre>
                <pre class="kotlin"><code data-trim data-noescape>
val opt: String? = ...
opt != null
opt ?: fallback
opt?.length ?: 0
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Types</h2>
                <h4>Either</h4>
                <aside class="notes">
                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
sealed class Either&lt;A, B> {
    class Left&lt;A, B>(val value: A) : Either&lt;A, B>()
    class Right&lt;A, B>(val value: B) : Either&lt;A, B>()
}
val e : Either&lt;String, Int>
when(e){
    is Left -> e.length > 2
    is Right -> e > 2
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Types</h2>
                <h4>Try</h4>
                <aside class="notes">
                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
sealed class Try&lt;A> {
    class Success&lt;A>(val value: A) : Try&lt;A>()
    class Failure&lt;A>(val ex: Exception) : Try&lt;A>()
}

fun &lt;A> doTry(work: () -> A): Try&lt;A> {
    return try {
        Try.Success(work())
    } catch (e: Exception) {
        Try.Failure(e)
    }
}
val result = doTry { "" }
when (result) {
    is Try.Failure -> result.ex
    is Try.Success -> result.value
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Types</h2>
                <h4>Other</h4>
                <aside class="notes">
                </aside>
                <ul>
                    <li>Java's CompletableFuture</li>
                    <li>ArrowKt's IO</li>
                    <li>Validated</li>
                    <li>Collections</li>
                </ul>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>Railway-Oriented Programming</h2>
                <h4>Monad Chains</h4>
                <aside class="notes">
                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
fun &lt;A, B> Try&lt;A>.andThen(next: (A) -> B): Try&lt;B> {
    return when (this) {
        is Try.Success -> doTry { next(this.value) }
        is Try.Failure -> Try.Failure&lt;B>(this.exception)
    }
}
val result = doTry { "" }
    .andThen { it.length }
    .andThen { it + 2 }
    .andThen {  it < 0 }
when (result) {
    is Try.Failure -> result.exception
    is Try.Success -> result.value
}
                </code></pre>
            </section>
            <section data-auto-animate data-timing="30">
                <h2>Railway-Oriented Programming</h2>
                <h4>Monad Chains</h4>
                <aside class="notes">
                </aside>
                <pre class="kotlin"><code data-trim data-noescape>
fun myFunct1(s: String) : Try&lt;Int> = doTry { it.length }
fun &lt;A, B> Try&lt;A>.andThen(next: (A) -> Try&lt;B>): Try&lt;B> {
    return when (this) {
        is Try.Success -> next(this.value)
        is Try.Failure -> Try.Failure&lt;B>(this.exception)
    }
}
val result = doTry { "" }
    .andThen { myFunc1(it) }
when (result) {
    is Try.Failure -> result.exception
    is Try.Success -> result.value
}
                </code></pre>
            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>Testing with Ad-Hoc Polymorphism</h2>
                <aside class="notes">

                </aside>

            </section>
        </section>
        <section>
            <section data-auto-animate data-timing="30">
                <h2>DSLs in Kotlin</h2>
                <aside class="notes">

                </aside>

            </section>
        </section>
        <section>
            <h2>More Resources</h2>
            <ul>
                <li>
                    <a href="https://wakingrufus.neocities.org/adhoc-polymorphism.html">Using Ad-hoc Polymorphism to Test Functional Kotlin</a> - Me
                </li>
                <li>
                    <a href="https://wakingrufus.neocities.org/staticwebarticle">Static Web Development with Kotlin DSLs</a> - Me
                </li>
                <li>
                    <a href="https://fsharpforfunandprofit.com/posts/recipe-part2/">Railway oriented programming</a>
                </li>
                <li>
                    <a href="http://www.yegor256.com/2014/06/09/objects-should-be-immutable.html">Objects Should Be Immutable</a> - <a href="http://www.yegor256.com/">Yegor Bugayenko</a>
                </li>
                <li>
                    <a href="https://www.infoq.com/presentations/Value-Values">The Value of Values</a> - <a href="https://twitter.com/richhickey">Rich Hickey</a>
                </li>
                <li>
                    <a href="https://gist.github.com/kbilsted/abdc017858cad68c3e7926b03646554e">Functional Core, Imperative Shell</a> - <a href="http://firstclassthoughts.co.uk/">Kasper B. Graversen</a>
                </li>
                <li>
                    <a href="https://kotlinexpertise.com/coping-with-kotlins-scope-functions/">Coping with Kotlin's Scope Functions</a> - <a href="https://simon-wirtz.de/">Simon Wirtz</a>
                </li>
            </ul>
        </section>
        <section data-timing="10">
            <div class="grid-area">
                <div style="text-align: left">
                    <div>https://wakingrufus.github.io/kotlin-2022/</div>
                    <p class="inline-image"><img alt="twitter logo" src="Twitter-Logo.png" height="48" width="48"/>
                        <span style="padding-left: .5em">@wakingrufus</span></p>
                    <p class="inline-image"><img alt="fediverse logo" src="fediverse.png" height="48" width="48"/>
                        <span style="padding-left: .5em">@wakingrufus@mastodon.technology</span>
                    </p>
                </div>
            </div>
        </section>
    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,
        defaultTiming: 60,
        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });


</script>
</body>
</html>
